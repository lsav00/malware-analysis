"""
Prints the number of unique distinct count of IPs in pcap file. Have to use tshark command to redirect to txt file (mypcapcsv.txt) first.

pcap_parser.py: bare bones


pcap_parser1.py: prints IP conversations, e.g.: 
['172.17.8.109', '172.17.8.255']
['172.17.8.109', '172.17.8.2']
['172.17.8.2', '172.17.8.109']
tshark command:
tshark -r C:\Users\savid\Desktop\malware_analysis\2019-01-28-traffic-analysis-exercise.pcap -o "gui.column.format:\"Num\",\"%m\",\"Proto\", \"%p\",\"Src\",\"%s\",\"Src_Port\",\"%S\",\"Dest\",\"%d\",\"Dest_Port\",\"%D\"" > "C:\Users\savid\Desktop\malware_analysis\mypcapcsv.txt"


pcap_parser2.py: add protocols to conversations
tshark command:
tshark -r C:\Users\savid\Desktop\malware_analysis\2019-01-28-traffic-analysis-exercise.pcap -o "gui.column.format:\"Num\",\"%m\",\"Proto\", \"%p\",\"Src\",\"%s\",\"Src_Port\",\"%S\",\"Dest\",\"%d\",\"Dest_Port\",\"%D\"" > "C:\Users\savid\Desktop\malware_analysis\mypcapcsv.txt"

"""

import os
import re




filename = os.path.join("C:\\", "Users", "savid", "Desktop", "malware_analysis", "mypcapcsv.txt")

new_list=[]
ip_list=[]
my_list=[]

file = open(filename, "r")
for line in file:
	line=line.replace(" " ,",")
	
	if line not in new_list:
		new_list.append(line) #captures all lines in csv format

	
for x in my_list:
	print(x)
"""
	string=""
	for d in dictionary:
		string+=(d + ":" + dictionary[d])
	print(string)
"""
		
		
"""		
ip_list.sort()
print("number of unique IPs: ", len(ip_list))
for x in ip_list:
	print(x)
"""